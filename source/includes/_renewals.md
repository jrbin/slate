# Renewals

Represent renewal notices for licenses that are going to expire. Renewals are generated by officers manually.

## Attributes

Attributes | Description
---------- | -----------
id | int, database primary key
address | string, temporary address
email | string, temporary email
status | int, the following table shows the meaning of each int
issueDate | date time string, date of the notice issued, in "DD/MM/YYYY hh:mm:ss" format
lastModified | date time string, in "DD/MM/YYYY hh:mm:ss" format
license | [license object](#licenses_licenses), not null, should only contain id and uri, referring to driver's license
payment | [payment obkect](#payments_payments), not null, should only contain id and uri, referring to driver's payment

Status | Description
------ | -----------
0 | renewal notice is newly created by an officer
1 | renewal needs to be reviewed by officer
2 | renewal notice is under review
3 | renewal has been checked by driver (or possibly has been reviewed by an officer) and has no problem, waiting for driver's payment
4 | renewal is successful, payment and update are done
5 | renewal is rejected, with reason
6 | renewal notice is archived by driver, driver cannot view it again

## Get Renewals

```http
GET /renewals HTTP/1.1
Authorization: token <ACCESS TOKEN>
```

> Returns an array of renewal objects

```json
[
  {
    "id": "1",
    "uri": "/renewals/1",
    "address": "Unit 1/97-99 Birriga Road, Bellevue Hill, NSW",
    "email": "youremail@email.com",
    "status": 0,
    "issueDate": "27/09/2017 12:00:56",
    "lastModified": "27/09/2017 12:00:56",
    "license": {
      "id": 1,
      "uri": "/licenses/1"
    },
    "payment": {
      "id": 1,
      "url": "/payments/1"
    }
  }
]
```

List all renewals, only officers can access this api.

## Get one renewal

```http
GET /renewals/1 HTTP/1.1
Authorization: token <ACCESS TOKEN>
```

> Returns

```json
{
  "id": "1",
  "uri": "/renewals/1",
  "address": "Unit 1/97-99 Birriga Road, Bellevue Hill, NSW",
  "email": "youremail@email.com",
  "status": 0,
  "issueDate": "27/09/2017 12:00:56",
  "lastModified": "27/09/2017 12:00:56",
  "license": {
    "id": 1,
    "uri": "/licenses/1"
  },
  "payment": {
    "id": 1,
    "url": "/payments/1"
  }
}
```

The license's owner can view the corresponding renewal notice.

## Create a renewal notice

```http
POST /renewals HTTP/1.1
Content-Type: application/json
Authorization: token <ACCESS TOKEN>

{
  "license": {
    "id": 1
  }
}
```

> Returns

```json
{
  "id": "1",
  "uri": "/renewals/1",
  "address": "Unit 1/97-99 Birriga Road, Bellevue Hill, NSW",
  "email": "youremail@email.com",
  "status": 0,
  "issueDate": "27/09/2017 12:00:56",
  "lastModified": "27/09/2017 12:00:56",
  "license": {
    "id": 1,
    "uri": "/licenses/1"
  },
  "payment": {
    "id": 1,
    "url": "/payments/1"
  }
}
```

Only officers can create a renewal notice for a expiring driver's license.

<aside class="notice">
On creation, a email is sent to the driver's registered email
</aside>

<aside class="notice">
A associated payment resource is also created.
</aside>

### Paratemers

Parameter | Description
--------- | -----------
license   | [license object](#licenses_licenses) reference, only need to provide id, see example

## Update a renewal notice

```http
PUT /renewals/1 HTTP/1.1
Content-Type: application/json
Authorization: token <ACCESS TOKEN>

{
  "id": "1",
  "address": "Unit 1/97-99 Birriga Road, Bellevue Hill, NSW",
  "email": "youremail222@email.com",
  "status": 1,
  "license": {
    "id": 1
  }
}
```

> Returns the updated object

```json
{
  "id": "1",
  "uri": "/renewals/1",
  "address": "Unit 1/97-99 Birriga Road, Bellevue Hill, NSW",
  "email": "youremail222@email.com",
  "status": 1,
  "issueDate": "27/09/2017 12:00:56",
  "lastModified": "27/09/2017 12:00:56",
  "license": {
    "id": 1,
    "uri": "/licenses/1"
  },
  "payment": {
    "id": 1,
    "url": "/payments/1"
  }
}
```

Can be done by license's owner or officers.

### Parameters

As `issueDate` cannot be changed and `lastModified` is updated automatically, they are not required to present in the parameters.

Parameter | Description
--------- | -----------
id        | should be the same in the url
address   |
email     |
status    |
license   | [license object](#licenses_licenses) reference, only need to provide id, see example


## Archive a renewal notice

Actually we consider it an update action instead of a delete operation.

Just update the status to 6, see [Update a renewal notice](#renewals_update-a-renewal-notice) for how to update.
